<html><head><script type='text/javascript' src='jquery-1.11.1.js'></script><script type='text/javascript' src='CollapsibleList.js'></script><script type='text/javascript' src='ApexDoc.js'></script><link rel='stylesheet' type='text/css' href='ApexDoc.css' /> </head><body><body><div style="background-color: #003672;width: 100%;height: 110px;color: white;display: flex;flex-direction: row;align-items: center;"><img src="./logo.jpeg" /><div style="margin-left: 32px"><h3>SOQL QueryBuilder API Documentation</h3><p>Check the project source files in the link below</p><p>Github: <a href="https://github.com/Leon3cs/soql-querybuilder-api">SOQL QueryBuilder API</a></p></div></div><table width='100%'><tr><td colspan='2' style='text-align: center;' >Show: <input type='checkbox' checked='checked' id='cbxglobal' onclick='ToggleScope("global", this.checked );'>global</input>&nbsp;&nbsp;<input type='checkbox' checked='checked' id='cbxpublic' onclick='ToggleScope("public", this.checked );'>public</input>&nbsp;&nbsp;<input type='checkbox' checked='checked' id='cbxwebService' onclick='ToggleScope("webService", this.checked );'>webService</input>&nbsp;&nbsp;</td></tr><tr style='vertical-align:top;' ><td width='20%' vertical-align='top' ><div class='sidebar'><div class='navbar'><nav role='navigation'><ul id='mynavbar'><li id='idMenuindex'><a href='.' onclick="gotomenu('index.html', event);return false;" class='nav-item'>Home</a></li><li class='header' id='idMenunull'><a class='nav-item nav-section-title' href='.' onclick="gotomenu(document.location.href, event);return false;" class='nav-item'>Classes<span class='caret'></span></a></li><ul><li class='subitem classscopepublic' id='idMenuQueryBuilder'><a href='.' onclick="gotomenu('QueryBuilder.html', event);return false;" class='nav-item sub-nav-item scopepublic'>QueryBuilder</a></li><li class='subitem classscopepublic' id='idMenuQueryBuilderClause'><a href='.' onclick="gotomenu('QueryBuilderClause.html', event);return false;" class='nav-item sub-nav-item scopepublic'>QueryBuilderClause</a></li></ul><li class='header' id='idMenunull'><a class='nav-item nav-section-title' href='.' onclick="gotomenu(document.location.href, event);return false;" class='nav-item'>Enums<span class='caret'></span></a></li><ul><li class='subitem classscopepublic' id='idMenuAgreggatorType'><a href='.' onclick="gotomenu('AgreggatorType.html', event);return false;" class='nav-item sub-nav-item scopepublic'>AgreggatorType</a></li><li class='subitem classscopepublic' id='idMenuLikeType'><a href='.' onclick="gotomenu('LikeType.html', event);return false;" class='nav-item sub-nav-item scopepublic'>LikeType</a></li><li class='subitem classscopepublic' id='idMenuOrderByType'><a href='.' onclick="gotomenu('OrderByType.html', event);return false;" class='nav-item sub-nav-item scopepublic'>OrderByType</a></li></ul><li class='header' id='idMenunull'><a class='nav-item nav-section-title' href='.' onclick="gotomenu(document.location.href, event);return false;" class='nav-item'>Interfaces<span class='caret'></span></a></li><ul><li class='subitem classscopepublic' id='idMenuIQueryBuilder'><a href='.' onclick="gotomenu('IQueryBuilder.html', event);return false;" class='nav-item sub-nav-item scopepublic'>IQueryBuilder</a></li><li class='subitem classscopepublic' id='idMenuIQueryBuilderClause'><a href='.' onclick="gotomenu('IQueryBuilderClause.html', event);return false;" class='nav-item sub-nav-item scopepublic'>IQueryBuilderClause</a></li></ul></ul></nav></div></div></div></td><td class='contentTD'><h2 class='section-title'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L9'>QueryBuilder</a></h2><div class='classSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L9'>public class QueryBuilder implements IQueryBuilder</a></div><div class='classDetails'>The IQueryBuilder implementation of QueryBuilder API. This is the main object to interact with to create a query using QueryBuilder API<br/><br/>Rafael Ara&#250;jo (leon3cs)<br/>2023</div><p/><h2 class='subsection-title'>Methods</h2><div class='subsection-container'> <ul class='methodTOC'><li class='methodscopepublic' ><a class='methodTOCEntry' href='#QueryBuilder'>QueryBuilder</a><div class='methodTOCDescription'>Initializes all objects required variables</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#addFieldAggregator'>addFieldAggregator</a><div class='methodTOCDescription'>Adds a single field with aggregation function to the query</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#addFields'>addFields</a><div class='methodTOCDescription'>Adds a list of fields to be selected</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#addSubquery'>addSubquery</a><div class='methodTOCDescription'>Adds a subquery to the main query (not yet implemented)</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#addWhere'>addWhere</a><div class='methodTOCDescription'>Adds a single where clause to the query. If added clause is not the first, it will be linked to the other clauses by an AND operator</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#addWhereAnd'>addWhereAnd</a><div class='methodTOCDescription'>Adds two clauses to the where expression with an AND operator if this expression is not the first in the clauses list, it will be linked to the other clauses by an AND operator</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#addWhereCustom'>addWhereCustom</a><div class='methodTOCDescription'>Adds a list of clauses with an especified expression to follow. The custom expression must be use numbers to represent the clauses as placeholders, and the query will be mounted in the order they came in the list, from 0 to n.</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#addWhereNot'>addWhereNot</a><div class='methodTOCDescription'>Adds a single clause to the where expression with an NOT operator if this expression is not the first in the clauses list, it will be linked to the other clauses by an AND operator</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#addWhereOr'>addWhereOr</a><div class='methodTOCDescription'>Adds two clauses to the where expression with an OR operator if this expression is not the first in the clauses list, it will be linked to the other clauses by an AND operator</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#build'>build</a><div class='methodTOCDescription'>After making all the necessary validations, the basic query is built and optional parameters like WHERE clauses, limits, order and groups are inserted into the query if they are present in the builder configuration</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#groupBy'>groupBy</a><div class='methodTOCDescription'>Adds a single field to be grouped by</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#limitBy'>limitBy</a><div class='methodTOCDescription'>Adds a limit to the query</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#orderBy'>orderBy</a><div class='methodTOCDescription'>Adds a list of fields to be added in the order by clause</div></li><li class='methodscopepublic' ><a class='methodTOCEntry' href='#selectFrom'>selectFrom</a><div class='methodTOCDescription'>Adds a SObjectType to select FROM</div></li></ul><div class='methodscopepublic' ><h2 class='methodHeader'><a id='QueryBuilder'/>QueryBuilder</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L153'>public QueryBuilder()</a></div><div class='methodDescription'>Initializes all objects required variables</div></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='addFieldAggregator'/>addFieldAggregator</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L206'>public QueryBuilder addFieldAggregator(Schema.SObjectField field, AgreggatorType.types type)</a></div><div class='methodDescription'>Adds a single field with aggregation function to the query</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>field</div><div class='paramDescription'>the SObjectField to be aggregated</div><div class='paramName'>type</div><div class='paramDescription'>the type of aggregation to be used</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>the current QueryBuilder instance with the added field aggregation</div><div class='methodSubTitle'>Example</div><code class='methodExample'>QueryBuilder builder = new QueryBuilder()
.addFieldAggregator(Opportunity.Amount, AgreggatorType.SUM);</code></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='addFields'/>addFields</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L192'>public QueryBuilder addFields(List&#60;Schema.SObjectField&#62; fields)</a></div><div class='methodDescription'>Adds a list of fields to be selected</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>fields</div><div class='paramDescription'>the fields list</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>the current QueryBuilder instance with the added fields</div><div class='methodSubTitle'>Example</div><code class='methodExample'>QueryBuilder builder = new QueryBuilder()
.addFields(new List&#60;Schema.SObjectField&#62;{
     Opportunity.Id,
     Opportunity.Name
});</code></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='addSubquery'/>addSubquery</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L456'>public QueryBuilder addSubquery(Schema.SObjectType relatedObject, QueryBuilder subquery)</a></div><div class='methodDescription'>Adds a subquery to the main query (not yet implemented)</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>relatedObject</div><div class='paramDescription'>the related object to be selected</div><div class='paramName'>subquery</div><div class='paramDescription'>a QueryBuilder instance with the subquery configuration</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>the current instance of QueryBuilder with the added subquery</div><div class='methodSubTitle'>Example</div><code class='methodExample'>QueryBuilder builder = new QueryBuilder()
.selectFrom(Account.SObjectType)
.addFields(new List&#60;Schema.SObjectField&#62;{
     Account.Id,
     Account.Name
})
.addSubquery(Oppotunity.SObjectType,
     new QueryBuilder()
         .selectFrom(Opportunity.SObjectType)
         .addFields(new List&#60;Schema.SObjectType&#62;{
             Oppotunity.Id,
             Oppotunity.Name
         }))</code></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='addWhere'/>addWhere</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L274'>public QueryBuilder addWhere(QueryBuilderClause clause)</a></div><div class='methodDescription'>Adds a single where clause to the query. If added clause is not the first, it will be linked to the other clauses by an AND operator</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>clause</div><div class='paramDescription'>the QueryBuilderClause object to be added</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>the current QueryBuilder isntance with the added clause</div><div class='methodSubTitle'>Example</div><code class='methodExample'>QueryBuilder builder = new QueryBuilder()
.addWhere(
     new QueryBuilderClause()
     .field(Opportunity.StageName)
     .isEqual('Closed Won')
);</code></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='addWhereAnd'/>addWhereAnd</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L307'>public QueryBuilder addWhereAnd(QueryBuilderClause clause1, QueryBuilderClause clause2)</a></div><div class='methodDescription'>Adds two clauses to the where expression with an AND operator if this expression is not the first in the clauses list, it will be linked to the other clauses by an AND operator</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>clause1</div><div class='paramDescription'>the first QueryBuilderClause</div><div class='paramName'>clause2</div><div class='paramDescription'>the second QueryBuilderClause</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>the current QueryBuilder instance with the added clauses</div><div class='methodSubTitle'>Example</div><code class='methodExample'>QueryBuilder builder = new QueryBuilder()
.addWhereAnd(
     new QueryBuilderClause()
     .field(Opportunity.StageName)
     .isEqual('Closed Won'),
     new QueryBuilderClause()
     .field(Opportunity.Amount)
     .isLessThan(10000)
);</code></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='addWhereCustom'/>addWhereCustom</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L422'>public QueryBuilder addWhereCustom(List&#60;QueryBuilderClause&#62; clauses, String expression)</a></div><div class='methodDescription'>Adds a list of clauses with an especified expression to follow. The custom expression must be use numbers to represent the clauses as placeholders, and the query will be mounted in the order they came in the list, from 0 to n.</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>clauses</div><div class='paramDescription'>the list of all clauses used in the expression</div><div class='paramName'>expression</div><div class='paramDescription'>the where expression the be followed</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>the current QueryBuilder instance with the added clauses</div><div class='methodSubTitle'>Example</div><code class='methodExample'>QueryBuilder builder = new QueryBuilder()
.addWhereCustom(
     new List&#60;QueryBuilderClause&#62;{
         new QueryBuilderClause()
         .field(Opportunity.Amount)
         .isLessThan(10000),
         new QueryBuilderClause()
         .field(Opportunity.StageName)
         .isEqual('Closed Won'),
         new QueryBuilderClause()
         .field(Opportunity.StageName)
         .isEqual('Closed Lost'),
     },
     '0 AND (1 OR 2)'
)</code></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='addWhereNot'/>addWhereNot</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L381'>public QueryBuilder addWhereNot(QueryBuilderClause clause)</a></div><div class='methodDescription'>Adds a single clause to the where expression with an NOT operator if this expression is not the first in the clauses list, it will be linked to the other clauses by an AND operator</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>clause1</div><div class='paramDescription'>the first QueryBuilderClause</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>the current QueryBuilder instance with the added clauses</div><div class='methodSubTitle'>Example</div><code class='methodExample'>QueryBuilder builder = new QueryBuilder()
.addWhereNot(
     new QueryBuilderClause()
     .field(Opportunity.StageName)
     .isEqual('Closed Won')
);</code></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='addWhereOr'/>addWhereOr</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L346'>public QueryBuilder addWhereOr(QueryBuilderClause clause1, QueryBuilderClause clause2)</a></div><div class='methodDescription'>Adds two clauses to the where expression with an OR operator if this expression is not the first in the clauses list, it will be linked to the other clauses by an AND operator</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>clause1</div><div class='paramDescription'>the first QueryBuilderClause</div><div class='paramName'>clause2</div><div class='paramDescription'>the second QueryBuilderClause</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>the current QueryBuilder instance with the added clauses</div><div class='methodSubTitle'>Example</div><code class='methodExample'>QueryBuilder builder = new QueryBuilder()
.addWhereOr(
     new QueryBuilderClause()
     .field(Opportunity.StageName)
     .isEqual('Closed Won'),
     new QueryBuilderClause()
     .field(Opportunity.Amount)
     .isLessThan(10000)
);</code></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='build'/>build</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L739'>public String build()</a></div><div class='methodDescription'>After making all the necessary validations, the basic query is built and optional parameters like WHERE clauses, limits, order and groups are inserted into the query if they are present in the builder configuration</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>parentQuery</div><div class='paramDescription'>the parent query which will receive a subquery</div><div class='paramName'>childQuery</div><div class='paramDescription'>the subquery to add the correct relationship name</div><div class='paramName'>relatedObject</div><div class='paramDescription'>the related object to get relationship data from</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>a string representing the query</div><div class='methodSubTitle'>Example</div><code class='methodExample'>QueryBuilder builder = new QueryBuilder()
     .selectFrom(Opportunity.getSObjectType())
     .addFields(new List&#60;Schema.SObjectField&#62;{
         Opportunity.Id,
         Opportunity.Name
     })
     .addFieldAggregator(Opportunity.Amount, AgreggatorType.COUNT)
     .groupBy(Opportunity.Id)
     .groupBy(Opportunity.Name)
     .addWhere(new QueryBuilderClause()
         .field(Opportunity.StageName)
         .isEqual('Closed Won'))
     .orderBy(new List&#60;Schema.SObjectField&#62;{Opportunity.Name}, OrderByType.ASCENDING_NULLS_LAST)
     .limitBy(10);
 String query = builder.build();
 System.debug(query)</code></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='groupBy'/>groupBy</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L219'>public QueryBuilder groupBy(Schema.SObjectField field)</a></div><div class='methodDescription'>Adds a single field to be grouped by</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>field</div><div class='paramDescription'>the SObjectField to be grouped by</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>the current QueryBuilder instance with the added grouping</div><div class='methodSubTitle'>Example</div><code class='methodExample'>QueryBuilder builder = new QueryBuilder()
.groupBy(Opportunity.Name);</code></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='limitBy'/>limitBy</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L254'>public QueryBuilder limitBy(Integer numRecords)</a></div><div class='methodDescription'>Adds a limit to the query</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>numRecords</div><div class='paramDescription'>the amount of records allowed to return by the query</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>the current QueryBuilder instance with the added limit</div><div class='methodSubTitle'>Example</div><code class='methodExample'>QueryBuilder builder = new QueryBuilder().limitBy(10);</code></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='orderBy'/>orderBy</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L240'>public QueryBuilder orderBy(List&#60;Schema.SObjectField&#62; fields, OrderByType.types type)</a></div><div class='methodDescription'>Adds a list of fields to be added in the order by clause</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>fields</div><div class='paramDescription'>the list of fields to be added</div><div class='paramName'>type</div><div class='paramDescription'>the type of ordering to be used</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>the current QueryBuilder instance with the added ordering</div><div class='methodSubTitle'>Example</div><code class='methodExample'>QueryBuilder builder = QueryBuilder()
.orderBy(
     new List&#60;Schema.SobjectField&#62;{
         Opportunity.Name,
         Opportunity.StageName
     },
     OrderByType.ASCENDING_NULLS_FIRST
);</code></div><div class='methodscopepublic' ><h2 class='methodHeader'><a id='selectFrom'/>selectFrom</h2><div class='methodSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L176'>public QueryBuilder selectFrom(Schema.SObjectType objType)</a></div><div class='methodDescription'>Adds a SObjectType to select FROM</div><div class='methodSubTitle'>Parameters</div><div class='paramName'>objType</div><div class='paramDescription'>object type to select FROM</div><div class='methodSubTitle'>Return Value</div><div class='methodReturns'>the current QueryBuilder instance with the added sObject</div><div class='methodSubTitle'>Example</div><code class='methodExample'>QueryBuilder builder = new QueryBuilder().selectFrom(Opportunity.getSObjectType());</code></div></div><p/><h2 class='section-title'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L124'>QueryBuilder.AccessException</a></h2><div class='classSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L124'>public class AccessException extends Exception</a></div><div class='classDetails'>It's thrown when there's a field or object in the QueryBuilder instance that the running user doesn't have access to</div><p/><p/><h2 class='section-title'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L130'>QueryBuilder.AggregationException</a></h2><div class='classSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L130'>public class AggregationException extends Exception</a></div><div class='classDetails'>It's thrown when there's validation errors when generating field aggregations</div><p/><p/><h2 class='section-title'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L142'>QueryBuilder.ExpressionException</a></h2><div class='classSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L142'>public class ExpressionException extends Exception</a></div><div class='classDetails'>It's thrown when there's validation errors with the formula described in the whereExpression property</div><p/><p/><h2 class='section-title'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L136'>QueryBuilder.GroupException</a></h2><div class='classSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L136'>public class GroupException extends Exception</a></div><div class='classDetails'>It's thrown when there's validation errors when generating field groups</div><p/><p/><h2 class='section-title'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L148'>QueryBuilder.SelectionException</a></h2><div class='classSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L148'>public class SelectionException extends Exception</a></div><div class='classDetails'>It's thrown when there's no fields to select in the query</div><p/><p/><h2 class='section-title'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L117'>QueryBuilder.SubqueryException</a></h2><div class='classSignature'><a target='_blank' class='hostedSourceLink' href='QueryBuilder.cls#L117'>public class SubqueryException extends Exception</a></div><div class='classDetails'>It's thrown when there's validation errors related to subqueries generation</div><p/></div></div></div></td></tr></table><hr/><center style='font-size:.8em;'><a href='http://github.com/SalesforceFoundation/ApexDoc' target='_blank'>Powered By ApexDoc</a></center></body></html>